@page "/recommendations"
@inject IHttpClientFactory HttpClientFactory

<PageTitle>Recommendations</PageTitle>

<h1>Recommended For You</h1>

@if (recommendations.Count == 0)
{
    <p><em>Loading recommendations...</em></p>
}
else
{
    <ul>
        @foreach (var item in recommendations)
        {
            <li>@item.StationName (@item.Score.ToString("0.000"))</li>
        }
    </ul>
}

@code {
    private static readonly Guid DemoUserId = Guid.Parse("22222222-2222-2222-2222-222222222222");
    private List<RecommendationDto> recommendations = new();

    protected override async Task OnInitializedAsync()
    {
        var client = HttpClientFactory.CreateClient("radio-api");
        recommendations = await client.GetFromJsonAsync<List<RecommendationDto>>($"/api/recommendations/{DemoUserId}")
            ?? new List<RecommendationDto>();
    }

    private sealed class RecommendationDto
    {
        public string StationName { get; set; } = string.Empty;
        public float Score { get; set; }
    }
}
